---
apiVersion: devopstoolkitseries.com/v1alpha1
kind: GitHubClaim
metadata:
  name: my-repo
  namespace: ($namespace)
spec:
  parameters:
    app:
      language: js
---
apiVersion: devopstoolkitseries.com/v1alpha1
kind: GitHub
metadata:
  labels:
    crossplane.io/claim-name: my-repo
    crossplane.io/claim-namespace: ($namespace)
spec:
  parameters:
    app:
      language: js
  (resourceRefs[?name == 'my-repo-main-js']):
  - apiVersion: repo.github.upbound.io/v1alpha1
    kind: RepositoryFile
---
apiVersion: repo.github.upbound.io/v1alpha1
kind: RepositoryFile
metadata:
  name: my-repo-main-js
spec:
  forProvider:
    commitAuthor: Crossplane
    commitEmail: github-provider@crossplane.io
    commitMessage: "Crossplane rocks"
    content: |
      console.log('Hello World');
    file: main.js
    repositorySelector:
      matchControllerRef: true
    branchSelector:
      matchControllerRef: true
---
apiVersion: repo.github.upbound.io/v1alpha1
kind: RepositoryFile
metadata:
  name: my-repo-dockerfile
spec:
  forProvider:
    commitAuthor: Crossplane
    commitEmail: github-provider@crossplane.io
    commitMessage: "Crossplane rocks"
    content: |
      FROM scratch
      RUN echo "I haven't used JS for a while so you'll need to find someone else to write this Dockerfile for you."
    file: Dockerfile
    repositorySelector:
      matchControllerRef: true
    branchSelector:
      matchControllerRef: true